chrome.runtime.onInstalled.addListener(()=>{chrome.contextMenus.create({id:"textcraft-parent",title:"TextCraft AI",contexts:["selection"]}),[{id:"formal",title:"Make Formal"},{id:"casual",title:"Make Casual"},{id:"joke",title:"Add Humor"},{id:"shakespearean",title:"Shakespearean"},{id:"emoji",title:"Add Emojis"},{id:"grammar",title:"Fix Grammar"},{id:"concise",title:"Make Concise"}].forEach(t=>{chrome.contextMenus.create({id:`textcraft-${t.id}`,parentId:"textcraft-parent",title:t.title,contexts:["selection"]})})});chrome.contextMenus.onClicked.addListener((e,t)=>{if(e.menuItemId.startsWith("textcraft-")&&e.menuItemId!=="textcraft-parent"){const r=e.menuItemId.replace("textcraft-",""),a=e.selectionText;chrome.tabs.sendMessage(t.id,{action:"transformText",transformationType:r,text:a})}});chrome.runtime.onMessage.addListener((e,t,r)=>{if(e.action==="getToken")return chrome.storage.local.get(["token"],a=>{r({token:a.token||null})}),!0;if(e.action==="setToken")return chrome.storage.local.set({token:e.token},()=>{r({success:!0})}),!0;if(e.action==="clearToken")return chrome.storage.local.remove(["token","user"],()=>{r({success:!0})}),!0});
